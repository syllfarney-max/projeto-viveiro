import { useState } from 'react'; export default function AdminMessages(){ const [token,setToken]=useState(''); const [messages,setMessages]=useState([]); const [error,setError]=useState(null); async function handleFetch(e){ e.preventDefault(); setError(null); try{ const res=await fetch(`${import.meta.env.VITE_API_URL||''}/api/messages`,{headers:{Authorization:'Bearer '+token}}); if(!res.ok) throw new Error('Falha'); const data=await res.json(); setMessages(data.messages||[]); }catch(err){ setError(err.message); } } return (<div style={{marginTop:12}}><form onSubmit={handleFetch}><input type='password' placeholder='JWT token' value={token} onChange={e=>setToken(e.target.value)} style={{width:'60%'}}/><button type='submit' style={{marginLeft:8}}>Carregar</button></form>{error && <div style={{color:'red'}}>{error}</div>}<ul>{messages.length===0? <li>Nenhuma mensagem</li> : messages.map(m=>(<li key={m.id}><strong>{m.name}</strong> ({m.email})<p>{m.message}</p><small>{m.created_at}</small></li>))}</ul></div>); }
